<div class="form-container">
  <h2>Register</h2>

  <!-- Registration Form -->
  <form (ngSubmit)="onSubmit()" #registerForm="ngForm">
    <div class="auth-form">
      
      <!-- Name Input -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Name</mat-label>
        <input
          matInput
          name="name"
          [(ngModel)]="model.name"
          required
          pattern="^[a-zA-Z\s\-]{2,30}$"
          #name="ngModel"
        />
        <mat-error *ngIf="name.errors?.['required'] && name.touched">
          Name is required.
        </mat-error>
        <mat-error *ngIf="name.errors?.['pattern'] && name.touched">
          Only letters, spaces, and hyphens allowed (2–30 chars).
        </mat-error>
      </mat-form-field>

      <!-- Surname Input -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Surname</mat-label>
        <input
          matInput
          name="surname"
          [(ngModel)]="model.surname"
          required
          pattern="^[a-zA-Z\s\-]{2,30}$"
          #surname="ngModel"
      />
        <mat-error *ngIf="surname.errors?.['required'] && surname.touched">
          Surname is required.
        </mat-error>
        <mat-error *ngIf="surname.errors?.['pattern'] && surname.touched">
          Only letters, spaces, and hyphens allowed (2–30 chars).
        </mat-error>
      </mat-form-field>

      <!-- Email Input -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Email</mat-label>
        <input
          matInput
          name="email"
          type="email"
          [(ngModel)]="model.email"
          required
          pattern="^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$"
          #email="ngModel"
      />
        <mat-error *ngIf="email.errors?.['required'] && email.touched">
          Email is required.
        </mat-error>
        <mat-error *ngIf="email.errors?.['pattern'] && email.touched">
          Please enter a valid email address.
        </mat-error>
      </mat-form-field>

      <!-- Password Input -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Password</mat-label>
        <input
          matInput
          type="password"
          name="password"
          [(ngModel)]="model.password"
          required
          pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&.])[A-Za-z\d@$!%*?&.]{8,}$"
          #password="ngModel"
      />
        <mat-error *ngIf="password.errors?.['required'] && password.touched">
          Password is required.
        </mat-error>
        <mat-error *ngIf="password.errors?.['pattern'] && password.touched">
          Password must be 8+ chars, include upper/lowercase, number, and symbol.
        </mat-error>
      </mat-form-field>

      <!-- Confirm Password Input -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Confirm Password</mat-label>
        <input
          matInput
          type="password"
          name="confirmPassword"
          [(ngModel)]="confirmPassword"
          required
          #confirm="ngModel"
      />
      </mat-form-field>

      <!-- Password Mismatch Warning -->
      <p class="error" *ngIf="passwordMismatch && confirm.touched">
        Passwords do not match.
      </p>

      <!-- Submit Button -->
      <button
        mat-raised-button
        color="primary"
        class="global-button"
        type="submit"
        aria-label="Register"
        [disabled]="registerForm.invalid || passwordMismatch || isLoading"
      >
        {{ isLoading ? 'Registering...' : 'Register' }}
      </button>

      <!-- Loading Spinner -->
      <div *ngIf="isLoading" class="center loading-spinner">
        <mat-spinner diameter="32"></mat-spinner>
      </div>

      <!-- Link to Login -->
      <p class="info-text">
        Have an account?
        <a routerLink="/login">Login</a>
      </p>

      <!-- Error Message -->
      <div *ngIf="errorMessage" class="error" role="alert">
        <mat-icon aria-hidden="true">error</mat-icon>
        {{ errorMessage }}
      </div>
    </div>
  </form>
</div>